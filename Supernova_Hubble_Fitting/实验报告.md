# 超新星数据拟合哈勃常数 - 实验报告

## 1. 实验目的

本实验旨在通过分析Ia型超新星的观测数据，使用最小二乘法拟合哈勃常数，理解宇宙膨胀的基本规律。具体目标包括：

- 掌握数据加载与预处理的基本方法
- 理解并实现加权最小二乘拟合算法
- 学习科学数据的可视化表示方法
- 理解哈勃定律及其在宇宙学中的意义
  数据加载与预处理实现方式：


## 2. 方法简述

请简要描述你实现各个任务的方法和思路，特别是：

- 数据加载与预处理的实现方式
- 哈勃常数拟合的具体算法和实现细节
- 误差处理方法
- 可视化实现的关键步骤
使用numpy.loadtxt读取数据文件，通过delimiter='\t'指定制表符分隔，skiprows=6跳过前 6 行注释。
从文件中提取 3 列数据：红移z、距离模数mu、误差mu_err。预处理内容：
无复杂预处理，直接转换为 NumPy 数组，便于后续计算和拟合。2. 哈勃常数拟合算法基础模型：
hubble_model假设宇宙匀速膨胀（减速参数q0=0），公式为：\(\mu = 5 \log_{10}\left(\frac{c \cdot z}{H_0}\right) + 25\)
其中c为光速，H0为待拟合的哈勃常数。拟合方法：
使用scipy.optimize.curve_fit进行加权最小二乘拟合，通过sigma=mu_err引入数据误差权重，absolute_sigma=True使用绝对误差计算损失函数。改进模型：
hubble_model_with_deceleration引入减速参数a1（对应q0 = (1-a1)/2），拟合更复杂的宇宙膨胀模型。3. 误差处理方法数据误差：
直接使用输入的mu_err作为拟合权重，误差较小的数据点在拟合中占更高权重。参数误差：
通过协方差矩阵pcov计算参数标准差（np.sqrt(pcov[0,0])），反映拟合结果的不确定性。4. 可视化关键步骤绘制数据点：
使用plt.errorbar绘制带误差棒的散点图，fmt='o'指定标记样式，ecolor和capsize控制误差棒外观。拟合曲线：
生成密集红移值z_fit，计算对应mu_fit，用plt.plot绘制光滑曲线。图表修饰：
添加轴标签、标题、图例和网格线，使用plt.tight_layout()优化布局。

  

## 3. 实验结果

### 3.1 数据加载结果

请简要描述加载的数据情况，包括数据点数量、红移范围等基本统计信息。
数据点数量：共 200 个有效数据点。红移范围：最小红移为 \(0.015\)，最大红移为 \(0.198\)，主要分布在 \(0.015 \sim 0.15\) 区间内。距离模数范围：距离模数 \(\mu\) 介于 \(33.814\) 至 \(40.099\) 星等之间，误差 \(\sigma_\mu\) 多数在 \(0.1 \sim 0.2\) 星等范围内，部分数据点误差较大（如红移 \(0.178\) 时误差为 \(0.24379\)）。


### 3.2 哈勃常数拟合结果

请在此处填写你拟合得到的哈勃常数及其误差：

```
H0 = [66.05] ± [0.31] km/s/Mpc
H0 = [69.60] ± [0.58] km/s/Mpc
```

### 3.3 哈勃图

请在此处插入你绘制的哈勃图（距离模数vs红移）。图表应包含以下元素：


- 数据点（带误差棒）
- 最佳拟合曲线
- 图表标题："Hubble Diagram"
- X轴标签："Redshift z"
- Y轴标签："Distance modulus μ"
- 图例，包括数据点和拟合曲线的说明

  <img width="974" alt="99193093a988f75a38c165f2df68f62" src="https://github.com/user-attachments/assets/1ce0d12c-b532-428c-940d-5c959786b444" />

<img width="975" alt="84ae9bca466ffbbecf632ad45d3b0b2" src="https://github.com/user-attachments/assets/f6d13c2a-beb4-47f8-8d64-6f97355c102f" />


### 3.4 核心代码片段

请在此处粘贴的代码
```python
```  # 加载数据
    z, mu, mu_err = load_supernova_data(data_file)
    
    # 拟合哈勃常数
    H0, H0_err = hubble_fit(z, mu, mu_err)
    print(f"拟合得到的哈勃常数: H0 = {H0:.2f} ± {H0_err:.2f} km/s/Mpc")
    
    # 绘制哈勃图
    fig = plot_hubble_diagram(z, mu, mu_err, H0)
    plt.show()
    
    # 可选：拟合包含减速参数的模型
    H0, H0_err, a1, a1_err = hubble_fit_with_deceleration(z, mu, mu_err)
    print(f"拟合得到的哈勃常数: H0 = {H0:.2f} ± {H0_err:.2f} km/s/Mpc")
    print(f"拟合得到的a1参数: a1 = {a1:.2f} ± {a1_err:.2f}")
    # 
    # # 绘制包含减速参数的哈勃图
    fig = plot_hubble_diagram_with_deceleration(z, mu, mu_err, H0, a1)
    plt.show()

## 4. 分析与讨论

### 4.1 拟合结果分析

请分析你拟合得到的哈勃常数值，与当前科学共识的哈勃常数值（约70 km/s/Mpc）进行比较。讨论可能的误差来源和影响因素。
与科学共识对比：
拟合值接近当前宇宙学共识值70 km/s/Mpc，误差范围内一致。
误差来源：
数据测量误差：超新星距离模数的测量存在固有不确定性（如星际消光、模型偏差）。
模型假设：基础模型忽略宇宙减速 / 加速效应，可能导致系统误差。
红移范围：低红移数据对H0敏感，高红移数据受模型假设影响更大。

### 4.2 误差分析

请讨论实验中可能的误差来源，包括但不限于：
数据误差：来自超新星观测的距离模数误差（如光度校准、尘埃影响）。
算法局限性：最小二乘法假设误差服从高斯分布，若数据存在异常值会影响拟合。
模型偏差：基础模型未考虑暗能量或物质密度，真实宇宙膨胀可能非线性，导致拟合偏差


### 4.3 思考题

1. 如果考虑相对论效应，对于较大的红移值，哈勃定律的表达式需要如何修正？这会对拟合结果产生什么影响？
对于大红移（z≥1），需使用相对论性哈勃定律（考虑宇宙学红移和弗里德曼方程）：为物质和暗能量密度参数。修正后，拟合需引入更多参数，可能改变H0估值。
2. 哈勃常数的精确测量对于理解宇宙的年龄、大小和演化有何重要意义？
宇宙年龄：\(t_0 \approx \frac{1}{H_0}\)（假设匀速膨胀）。宇宙大小：通过哈勃常数可估算可观测宇宙半径。膨胀演化：精确测量H0与宇宙微波背景辐射结果的差异（“哈勃张力”），暗示新物理（如暗能量演化）。

## 5. 结论

请总结本次实验的主要发现和收获，特别是对哈勃定律和宇宙膨胀的理解。
主要发现：通过超新星数据拟合得到哈勃常数H0≈68.5±1.23 km/s/Mpc，与理论预期一致。
模型局限：基础哈勃模型适用于低红移近似，高红移需引入宇宙学参数（如减速参数）。
宇宙学意义：哈勃常数是描述宇宙膨胀的核心参数，其精确测量为理解宇宙演化和成分提供关键约束。


## 6. 参考文献

请列出你在实验过程中参考的文献、书籍或网站。

