# 中子共振散射实验数据分析 - 实验报告

## 1. 实验目的

本实验旨在通过分析中子共振散射实验数据，掌握两种插值方法(拉格朗日多项式和三次样条)的实现和应用。具体目标包括：

- 理解并实现拉格朗日多项式插值算法
- 理解并实现三次样条插值算法
- 学习使用插值方法分析实验数据中的共振峰特性
- 比较不同插值方法的结果和适用性

## 2. 方法简述

请简要描述你实现各个任务的方法和思路，特别是：

- 拉格朗日多项式插值的实现方式
- 三次样条插值的实现方式
- 共振峰位置和半高全宽(FWHM)的计算方法
- 可视化实现的关键步骤

## 3. 实验结果

### 3.1 插值结果对比

请在此处描述两种插值方法的实现结果：

1. 拉格朗日多项式插值结果：
   - 插值曲线特征：
   - 计算得到的共振峰位置：__76.61____ MeV
   - 计算得到的FWHM：__53.88____ MeV

2. 三次样条插值结果：
   - 插值曲线特征：
   - 计算得到的共振峰位置：___74.46___ MeV
   - 计算得到的FWHM：__53.44____ MeV

### 3.2 插值曲线图

请在此处插入你绘制的插值曲线对比图(原始数据点和两种插值曲线)。图表应包含以下元素：
# 中子共振散射实验数据分析 - 实验报告
![image](https://github.com/user-attachments/assets/982cc546-64dd-44a8-8e98-4e1b3f120e42)


## 1. 实验目的

本实验旨在通过分析中子共振散射实验数据，掌握两种插值方法(拉格朗日多项式和三次样条)的实现和应用。具体目标包括：

- 理解并实现拉格朗日多项式插值算法
- 理解并实现三次样条插值算法
- 学习使用插值方法分析实验数据中的共振峰特性
- 比较不同插值方法的结果和适用性

## 2. 方法简述

请简要描述你实现各个任务的方法和思路，特别是：

- 拉格朗日多项式插值的实现方式
- 三次样条插值的实现方式
- 共振峰位置和半高全宽(FWHM)的计算方法
- 可视化实现的关键步骤

## 3. 实验结果

### 3.1 插值结果对比

请在此处描述两种插值方法的实现结果：

1. 拉格朗日多项式插值结果：
   - 插值曲线特征：
   - 计算得到的共振峰位置：___76.61___ MeV
   - 计算得到的FWHM：__53.88____ MeV

2. 三次样条插值结果：
   - 插值曲线特征：
   - 计算得到的共振峰位置：__76.46____ MeV
   - 计算得到的FWHM：__53.44____ MeV

### 3.2 插值曲线图

请在此处插入你绘制的插值曲线对比图(原始数据点和两种插值曲线)。图表应包含以下元素：

- 原始数据点(带误差棒)
- 拉格朗日插值曲线
- 三次样条插值曲线
- 图表标题："Neutron Resonance Scattering Cross Section Analysis"
- X轴标签："Energy (MeV)"
- Y轴标签："Cross Section (mb)"
- 图例，包括数据点和两种插值曲线的说明
![image](https://github.com/user-attachments/assets/3cdf8673-d69a-469b-9c2e-8f8a51a02e0f)

### 3.3 核心代码片段

请在此处粘贴你实现的代码：

```python
[STUDENT_CODE_HERE]
```
## 4. 分析与讨论
### 4.1 插值方法比较
请分析两种插值方法的结果差异，讨论：

1. 曲线平滑度比较
2. 边界行为差异
3. 计算效率比较
4. 哪种方法更适合本实验数据？为什么？

   1. 曲线平滑度比较：三次样条插值曲线平滑连续，能够很好地反映数据趋势；拉格朗日多项式插值曲线因高阶多项式特性，存在明显震荡，平滑度较差。
   2. 边界行为差异：拉格朗日多项式插值在边界处受数据点影响大，震荡剧烈；三次样条插值通过边界条件约束，在边界处过渡平滑 。
   3. 计算效率比较：拉格朗日多项式插值每次计算需重新计算所有基函数，计算量随数据点增多呈指数增长；三次样条插值通过建立和求解线性方程组确定系数，后续计算插值点效率更高。
   4. 适用性：三次样条插值更适合本实验数据，因为实验数据期望得到平滑的曲线以准确反映物理量变化趋势，拉格朗日插值的震荡可能导致共振峰位置和半高全宽计算出现偏差。
### 4.2 共振峰分析
请讨论你得到的共振峰位置和FWHM结果：

1. 与原始数据峰值位置的比较
2. 两种插值方法结果的差异
3. 可能的误差来源

  1. 与原始数据峰值位置的比较：原始数据中峰值位置大致在能量为75 MeV处，两种插值方法得到的共振峰位置与之接近，但因插值对数据的平滑处理，会使峰值位置产生微小偏移 。
  2. 两种插值方法结果的差异：拉格朗日插值和三次样条插值得到的共振峰位置和半高全宽数值存在差异，主要是由于拉格朗日插值的震荡导致局部极值点位置和幅度改变，而三次样条插值更稳定。
  3. 可能的误差来源：误差来源包括原始数据测量误差、插值方法本身的近似误差（如拉格朗日插值的Runge现象）、数据点分布不均匀以及半高全宽计算时寻找阈值对应点的近似误差。
### 4.3 思考题
1. 对于这种类型的实验数据，为什么三次样条插值通常比高阶多项式插值更合适？
2. 如果数据点更密集或更稀疏，会对插值结果产生什么影响？

   1. 三次样条插值的优势：对于实验数据，三次样条插值通过分段三次多项式拟合，并保证各段函数在连接点处一阶和二阶导数连续，避免了高阶多项式插值的Runge现象，能够提供平滑且符合物理规律的曲线，更准确地反映数据变化趋势。而高阶多项式插值在数据点较多时容易产生剧烈震荡，导致结果失真。
  2. 数据点密度的影响：若数据点更密集，插值结果会更接近真实函数，误差减小，两种插值方法的差异也会缩小；若数据点更稀疏，拉格朗日插值的震荡现象会更加明显，误差增大，三次样条插值虽仍能保持平滑，但在数据稀疏区域的拟合准确性也会下降 。
## 5. 结论
请总结本次实验的主要发现和收获，特别是：

- 对两种插值方法特点的理解
- 中子共振散射数据分析的经验
- 插值方法选择对结果分析的影响
- 原始数据点(带误差棒)
- 拉格朗日插值曲线
- 三次样条插值曲线
- 图表标题："Neutron Resonance Scattering Cross Section Analysis"
- X轴标签："Energy (MeV)"
- Y轴标签："Cross Section (mb)"
- 图例，包括数据点和两种插值曲线的说明
- 对两种插值方法特点的理解：拉格朗日多项式插值简单直接，但高阶时易出现震荡，不适用于数据点较多或需平滑曲线的场景；三次样条插值通过分段拟合和导数连续性约束，能够得到平滑稳定的曲线，更适合处理实验数据。
- 中子共振散射数据分析的经验：通过插值方法可有效分析实验数据的共振峰特性，但需根据数据特点选择合适的插值方法。同时，在计算共振峰位置和半高全宽时，要考虑插值方法带来的影响以及误差来源。
- 插值方法选择对结果分析的影响：不同插值方法会显著影响分析结果，选择不当可能导致共振峰位置和半高全宽等关键参数出现较大偏差。因此，在实际数据分析中，需综合考虑数据特征、分析目的和插值方法的优缺点，以确保结果的准确性和可靠性。
### 3.3 核心代码片段

请在此处粘贴你实现的代码：

```python
[STUDENT_CODE_HERE]
```
## 4. 分析与讨论
### 4.1 插值方法比较
请分析两种插值方法的结果差异，讨论：

1. 曲线平滑度比较
2. 边界行为差异
3. 计算效率比较
4. 哪种方法更适合本实验数据？为什么？
### 4.2 共振峰分析
请讨论你得到的共振峰位置和FWHM结果：

1. 与原始数据峰值位置的比较
2. 两种插值方法结果的差异
3. 可能的误差来源
### 4.3 思考题
1. 对于这种类型的实验数据，为什么三次样条插值通常比高阶多项式插值更合适？
2. 如果数据点更密集或更稀疏，会对插值结果产生什么影响？
## 5. 结论
请总结本次实验的主要发现和收获，特别是：

- 对两种插值方法特点的理解
- 中子共振散射数据分析的经验
- 插值方法选择对结果分析的影响
